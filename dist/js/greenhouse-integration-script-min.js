jQuery(document).ready(function(e){var t=window.location.href,n=(t=t.substr(0,t.indexOf(".com")+4))+"/jobs/?id=",a=function(e,t,n,a){this.title=e,this.categoryArr=t,this.appendID=n,this.markup=a},r=function(e,t){this.query=e,this.amount=t},o=[],i=function(t,n){var a=e(n).length,r=e(t).length;a===r?e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>all</strong>")):e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>"+a+"</strong> of <strong>"+r+"</strong>"))},l=window.location.href;if(l.indexOf("/jobs/")>0){var s=l.substr(l.indexOf("?id=")+4,l.length);if(-1!==l.indexOf("?id=")){e("#job-background").css("opacity",0);var c="https://boards-api.greenhouse.io/v1/boards/anaplan/jobs/"+s;e.getJSON(c,function(t){console.log(t);var a=t.content.replace(/&lt;/gi,"<");a=(a=a.replace(/&gt;/gi,">")).replace(/&quot;/gi,'"'),e("#job-title").find("h1").html(t.title),e("#job-title-content").find("h3").html(t.title),e("#job-location").find("h3").html(t.location.name.trim()),e("#job-location-content").find("h5").html(t.location.name.trim()),e("#job-content").html(a),e("#job-greenhouse-href").attr("href",t.absolute_url);var r="/wp-content/uploads/2018/12/solution_IT_feature.jpg",o="/wp-content/uploads/2018/12/solution_sales_feature.jpg";switch(t.departments[0].name){case"Engineering":case"IT":case"Technical Operations":i=r;break;case"Field Sales":case"Inside Sales":case"Sales Development":case"Pre-Sales":case"Marketing":i=o;break;default:var i="/wp-content/uploads/2018/12/solution_supplyChain_feature.jpg"}e("#job-background").css({"background-image":"url("+i+")"}),setTimeout(function(){e("#job-background").css("opacity",1)},250);var l=t.departments[0].name;e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){e.each(t.departments,function(a,r){var o=[],i="<div class='job-related--row'><p id='job-related--title' class='job-related--title'><a href='${job-href}'>${job-title}</a></p><p id='job-related--location' class='job-related--location'>${job-location}</p></div>",c=function(e){var t=n+e.id,a=i.replace(/\$\{job-title\}/gi,e.title);return a=(a=a.replace(/\$\{job-location\}/gi,e.location.name)).replace(/\$\{job-href\}/gi,t)};if(t.departments[a].name===l){var u=function(n,a){o.length<2&&a<t.departments.length?(e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var n=c(t);o.push(n)}}),u(n,++a)):o.length<2&&a===t.departments.length&&(a=n,e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var n=c(t);o.push(n)}}),u(n,++a))};u(0,a),e("#job-related-attach").html(o.join(""))}})})})}else window.location.href=window.location.href.substr(0,window.location.href.indexOf("/jobs"))+"/job-listing/"}else-1!==l.indexOf("/engineering")?l+="?filter=true;category=Engineering":-1!==l.indexOf("/sales")&&(l+="?filter=true;category=Field%20Sales&Pre-Sales&Sales%20Development"),e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){var l=0,s=0,c=0,u=[],p=[],h=[],d=[],f=[],g="<li><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${value}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>",b="<div data-category='${category}' data-city='${city}' data-country='${country}' class='job-list-row job-list-row--active job-list-row--filtered'><div class='job-list-column job-list-column--large'><p><a href='${job-href}'>${job-title}</a></p></div><div class='job-list-column job-list-column--small'><p>${category}</p></div><div class='job-list-column job-list-column--small'><p>${location}</p></div></div>",m=function(e,t,n){var a=e;if(t.length<1){var o=new r(a,1);t.push(o)}else if(n<t.length){if(a===t[n].query)return t[n].amount+=1,!1;m(e,t,++n)}else{o=new r(a,1);t.push(o)}};e.each(t.departments,function(e,t){if(t.jobs.length>0&&"Template"!==t.name){var a=new r(t.name.replace("Inside Sales","Sales Development"),t.jobs.length);d.push(a);var o=t.jobs.map(function(e,t){var r=e.location.name.split(","),o=n+e.id;if(r.length>1){var i=r[0].trim().replace(/(\s-)|(-\s)/gi,"-"),l=r[1].trim().replace(/(\s-)|(-\s)/gi,"-");m(i,h,0),m(l,p,0),s=(s=b.replace(/\$\{city\}/gi,i)).replace(/\$\{country\}/gi,l)}else{l=r[0].trim().replace(/(\s-)|(-\s)/gi,"-");m(r[0],p,0);var s=b.replace(/\$\{country\}/gi,l)}return(s=(s=(s=s.replace(/\$\{job-href\}/gi,o)).replace(/\$\{job-title\}/gi,e.title)).replace(/\$\{location\}/gi,e.location.name.trim())).replace(/\$\{category\}/gi,a.query.trim())});f.push(o.join(""))}switch(l+=t.jobs.length,t.name){case"Engineering":s+=t.jobs.length;var i=new r("engineering",s);u.push(i);break;case"Field Sales":c+=t.jobs.length;i=new r("sales",c);u.push(i)}}),e("<div/>",{html:f.join("")}).appendTo("#job-attach");var j=function(e){return e.sort(function(e,t){var n=e.query.toUpperCase(),a=t.query.toUpperCase();return n<a?-1:n>a?1:0})};p=j(p),h=j(h);var v=new a("Category",d,"category",g),y=new a("Country",p,"country",g),w=new a("City",h,"city",g);o.push(v),o.push(y),o.push(w);var q=new r("all",l);u.push(q),e.each(u,function(t,n){var a;e('*[data-job-type="'+(a=n).query+'"]').html(a.amount)});var $=function(t,n){if(n<t.length){var a=t[n].categoryArr,r=t[n].markup,o=a.map(function(e,t){return r.replace(/\$\{value\}/gi,e.query).replace(/\$\{amount\}/gi,e.amount)});e("<ul/>",{html:o.join("")}).appendTo("#"+t[n].appendID),$(t,++n)}};$(o,0),i(".job-list-row",".job-list-row--active.job-list-row--filtered")});var u=function(){var t=[],n=[],a=function(e){this.query=e,this.arr=[]},r=function(e,t,n){t<e.length&&(e.eq(t).hasClass(n)||(e.eq(t).removeClass("job-list-row--active"),e.eq(t).removeClass("job-list-row--filtered")),r(e,++t,n))},o=function(e,t,n){t<e.length&&(e.eq(t).hasClass("job-list-row--title")||(e.eq(t).addClass("job-list-row--active"),e.eq(t).addClass("job-list-row--filtered")),o(e,++t,n))},l=e("*[type='checkbox']"),s=function(e,n,a){n<e.length&&(e[n].query.trim()===a.query.trim()?e[n].arr.push(a.arr[0]):n+1===e.length&&e[n].query.trim()!==a.query.trim()?t.push(a):s(e,++n,a))},c=function(e,n){if(n<e.length){if(!0===e.eq(n).prop("checked")&&void 0===e.eq(n).attr("id")){var r,o=e.eq(n).attr("value").trim(),i=e.eq(n).parents(".item-list").attr("id").trim();if(t.length>0)(r=new a(i)).arr.push(o),s(t,0,r);else(r=new a(i)).arr.push(o),t.push(r)}c(e,++n)}};r(e(".job-list-row"),0,"job-list-row--title"),c(l,0);var u=function(e,t,a){if(t<e.length){var r="<span class='job-filter-button job-filter-button--${color}' data-${query}='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>";r=(r=(r="category"===a?r.replace(/\$\{color\}/gi,"blue"):r.replace(/\$\{color\}/gi,"green")).replace(/\$\{filter\}/gi,e[t])).replace(/\$\{query\}/gi,a),n.push(r),u(e,++t,a)}},p=function(t,n,a){n<t.length&&(e("*[data-"+a+"='"+t[n]+"']").addClass("job-list-row--filtered"),p(t,++n,a))},h=function(t,n,a){n<t.length&&(e("*[data-"+a+"='"+t[n]+"']").addClass("job-list-row--active"),h(t,++n,a))},d=function(t,a){a<t.length&&(0===a&&"category"===t[a].query&&1!==t.length?(h(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0===a&&"category"===t[a].query&&1===t.length?(h(t[a].arr,0,t[a].query),p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0!==a||"city"!==t[a].query&&"country"!==t[a].query||1===t.length?a>0&&("city"===t[a].query||"country"===t[a].query)?(p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0===a&&1===t.length&&(h(t[a].arr,0,t[a].query),p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):h(t[a].arr,0,t[a].query),d(t,++a)),e("#job-filter-buttons").html(n.join(""))};0===t.length?(r(e(".job-list-row"),0,"job-list-row--title"),o(e(".job-list-row"),0,"job-list-row--title"),e("#job-filter-buttons").html("")):d(t,0),i(".job-list-row",".job-list-row--active.job-list-row--filtered")},p=!1,h=function(e,t){if(t<e.length){var n=e[t].substr(e[t].indexOf("=")+1,e[t].length).split("&");d(n,0),h(e,++t)}},d=function(t,n){n<t.length&&(e("*[value='"+t[n].replace(/%20/gi," ")+"']").eq(0).prop("checked",!0),d(t,++n))},f=function(t){!1===p&&-1!==t.indexOf("?filter=true;")?(e("*[type='checkbox']").length>0?p=!0:pageload=!1,setTimeout(function(){f(t)},500)):!0===p&&-1!==t.indexOf("?filter=true;")&&function(e){if(-1!==e.indexOf("?filter=true;")){var t=e.substr(e.indexOf("?filter=true;")+13,e.length),n=t.substr(0,t.length).split(";");h(n,0),u()}}(t)};f(l),e(document).on("click","*[type='checkbox']",function(e){u()}),e(document).on("click",".job-filter-button",function(t){t.preventDefault(),e.each(e(this).data(),function(t,n){e("#"+t).find("*[value='"+n+"']").prop("checked",!1)}),u()}),e(document).on("input","#form-field-name",function(t){console.log(e("#form-field-name").val())})});