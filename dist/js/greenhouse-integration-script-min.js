jQuery(document).ready(function(e){var t=window.location.href,a=(t=t.substr(0,t.indexOf(".com")+4))+"/jobs/?id=",r=function(e,t,a,r){this.title=e,this.categoryArr=t,this.appendID=a,this.markup=r},n=function(e,t){this.query=e,this.amount=t},o=[],i=function(t,a){var r=e(a).length,n=e(t).length;r===n?e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>all</strong>")):e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>"+r+"</strong> of <strong>"+n+"</strong>"))},l=window.location.href;if(l.indexOf("/jobs/")>0){var s=l.substr(l.indexOf("?id=")+4,l.length);if(-1!==l.indexOf("?id=")){e("#job-background").css("opacity",0);var c="https://boards-api.greenhouse.io/v1/boards/anaplan/jobs/"+s;e.getJSON(c,function(t){var r=t.content.replace(/&lt;/gi,"<");r=(r=r.replace(/&gt;/gi,">")).replace(/&quot;/gi,'"'),e("#job-title").find("h1").html(t.title),e("#job-title-content").find("h3").html(t.title),e("#job-location").find("h3").html(t.location.name.trim()),e("#job-location-content").find("h5").html(t.location.name.trim()),e("#job-content").html(r),e("#job-greenhouse-href").attr("href",t.absolute_url);var n="/wp-content/uploads/2018/12/solution_IT_feature.jpg",o="/wp-content/uploads/2018/12/solution_sales_feature.jpg";switch(t.departments[0].name){case"Engineering":case"IT":case"Technical Operations":i=n;break;case"Field Sales":case"Inside Sales":case"Sales Development":case"Pre-Sales":case"Marketing":i=o;break;default:var i="/wp-content/uploads/2018/12/solution_supplyChain_feature.jpg"}e("#job-background").css({"background-image":"url("+i+")"}),setTimeout(function(){e("#job-background").css("opacity",1)},250);var l=t.departments[0].name;e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){e.each(t.departments,function(r,n){var o=[],i="<div class='job-related--row'><p id='job-related--title' class='job-related--title'><a href='${job-href}'>${job-title}</a></p><p id='job-related--location' class='job-related--location'>${job-location}</p></div>",c=function(e){var t=a+e.id,r=i.replace(/\$\{job-title\}/gi,e.title);return r=(r=r.replace(/\$\{job-location\}/gi,e.location.name)).replace(/\$\{job-href\}/gi,t)};if(t.departments[r].name===l){var u=function(a,r){o.length<2&&r<t.departments.length?(e.each(t.departments[r].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var a=c(t);o.push(a)}}),u(a,++r)):o.length<2&&r===t.departments.length&&(r=a,e.each(t.departments[r].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var a=c(t);o.push(a)}}),u(a,++r))};u(0,r),e("#job-related-attach").html(o.join(""))}})})})}else window.location.href=window.location.href.substr(0,window.location.href.indexOf("/jobs"))+"/job-listing/"}else-1!==l.indexOf("/engineering")?l+="?filter=true;category=Engineering":-1!==l.indexOf("/sales")&&(l+="?filter=true;category=Field%20Sales&Pre-Sales&Sales%20Development"),e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){var l=0,s=0,c=0,u=[],p=[],h=[],d=[],g=[],f="<li><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${value}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>",b="<div data-category='${category}' data-city='${city}' data-country='${country}' class='job-list-row job-list-row--active job-list-row--filtered'><div class='job-list-column job-list-column--large'><p><a href='${job-href}'>${job-title}</a></p></div><div class='job-list-column job-list-column--small'><p>${category}</p></div><div class='job-list-column job-list-column--small'><p>${location}</p></div></div>",m=function(e,t,a){var r=e;if(t.length<1){var o=new n(r,1);t.push(o)}else if(a<t.length){if(r===t[a].query)return t[a].amount+=1,!1;m(e,t,++a)}else{o=new n(r,1);t.push(o)}};e.each(t.departments,function(e,t){if(t.jobs.length>0&&"Template"!==t.name){var r=new n(t.name.replace("Inside Sales","Sales Development"),t.jobs.length);d.push(r);var o=t.jobs.map(function(e,t){var n=e.location.name.split(","),o=a+e.id;if(n.length>1){var i=n[0].trim().replace(/(\s-)|(-\s)/gi,"-"),l=n[1].trim().replace(/(\s-)|(-\s)/gi,"-");m(i,h,0),m(l,p,0),s=(s=b.replace(/\$\{city\}/gi,i)).replace(/\$\{country\}/gi,l)}else{l=n[0].trim().replace(/(\s-)|(-\s)/gi,"-");m(n[0],p,0);var s=b.replace(/\$\{country\}/gi,l)}return(s=(s=(s=s.replace(/\$\{job-href\}/gi,o)).replace(/\$\{job-title\}/gi,e.title)).replace(/\$\{location\}/gi,e.location.name.trim())).replace(/\$\{category\}/gi,r.query.trim())});g.push(o.join(""))}switch(l+=t.jobs.length,t.name){case"Engineering":s+=t.jobs.length;var i=new n("engineering",s);u.push(i);break;case"Field Sales":c+=t.jobs.length;i=new n("sales",c);u.push(i)}}),e("<div/>",{html:g.join("")}).appendTo("#job-attach");var j=function(e){return e.sort(function(e,t){var a=e.query.toUpperCase(),r=t.query.toUpperCase();return a<r?-1:a>r?1:0})};p=j(p),h=j(h);var v=new r("Category",d,"category",f),y=new r("Country",p,"country",f),w=new r("City",h,"city",f);o.push(v),o.push(y),o.push(w);var q=new n("all",l);u.push(q),e.each(u,function(t,a){var r;e('*[data-job-type="'+(r=a).query+'"]').html(r.amount)});var $=function(t,a){if(a<t.length){var r=t[a].categoryArr,n=t[a].markup,o=r.map(function(e,t){return n.replace(/\$\{value\}/gi,e.query).replace(/\$\{amount\}/gi,e.amount)});e("<ul/>",{html:o.join("")}).appendTo("#"+t[a].appendID),$(t,++a)}};$(o,0),i(".job-list-row",".job-list-row--active.job-list-row--filtered")});var u=function(){var t=[],a=[],r=function(e){this.query=e,this.arr=[]},n=function(e,t,a){t<e.length&&(e.eq(t).hasClass(a)||(e.eq(t).removeClass("job-list-row--active"),e.eq(t).removeClass("job-list-row--filtered")),n(e,++t,a))},o=function(e,t,a){t<e.length&&(e.eq(t).hasClass("job-list-row--title")||(e.eq(t).addClass("job-list-row--active"),e.eq(t).addClass("job-list-row--filtered")),o(e,++t,a))},l=e("*[type='checkbox']"),s=function(e,a,r){a<e.length&&(e[a].query.trim()===r.query.trim()?e[a].arr.push(r.arr[0]):a+1===e.length&&e[a].query.trim()!==r.query.trim()?t.push(r):s(e,++a,r))},c=function(e,a){if(a<e.length){if(!0===e.eq(a).prop("checked")&&void 0===e.eq(a).attr("id")){var n,o=e.eq(a).attr("value").trim(),i=e.eq(a).parents(".item-list").attr("id").trim();if(t.length>0)(n=new r(i)).arr.push(o),s(t,0,n);else(n=new r(i)).arr.push(o),t.push(n)}c(e,++a)}};n(e(".job-list-row"),0,"job-list-row--title"),c(l,0);var u=function(e,t,r){if(t<e.length){var n="<span class='job-filter-button job-filter-button--${color}' data-${query}='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>";n=(n=(n="category"===r?n.replace(/\$\{color\}/gi,"blue"):n.replace(/\$\{color\}/gi,"green")).replace(/\$\{filter\}/gi,e[t])).replace(/\$\{query\}/gi,r),a.push(n),u(e,++t,r)}},p=function(t,a,r){a<t.length&&(e("*[data-"+r+"='"+t[a]+"']").addClass("job-list-row--filtered"),p(t,++a,r))},h=function(t,a,r){a<t.length&&(e("*[data-"+r+"='"+t[a]+"']").addClass("job-list-row--active"),h(t,++a,r))},d=function(t,r){r<t.length&&(0===r&&"category"===t[r].query&&1!==t.length?(h(t[r].arr,0,t[r].query),u(t[r].arr,0,t[r].query)):0===r&&"category"===t[r].query&&1===t.length?(h(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query),u(t[r].arr,0,t[r].query)):0!==r||"city"!==t[r].query&&"country"!==t[r].query||1===t.length?r>0&&("city"===t[r].query||"country"===t[r].query)?(p(t[r].arr,0,t[r].query),u(t[r].arr,0,t[r].query)):0===r&&1===t.length&&(h(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query),u(t[r].arr,0,t[r].query)):h(t[r].arr,0,t[r].query),d(t,++r)),e("#job-filter-buttons").html(a.join(""))};0===t.length?(n(e(".job-list-row"),0,"job-list-row--title"),o(e(".job-list-row"),0,"job-list-row--title"),e("#job-filter-buttons").html("")):d(t,0),i(".job-list-row",".job-list-row--active.job-list-row--filtered")},p=!1,h=function(e,t){if(t<e.length){var a=e[t].substr(e[t].indexOf("=")+1,e[t].length).split("&");d(a,0),h(e,++t)}},d=function(t,a){a<t.length&&(e("*[value='"+t[a].replace(/%20/gi," ")+"']").eq(0).prop("checked",!0),d(t,++a))},g=function(t){!1===p&&-1!==t.indexOf("?filter=true;")?(e("*[type='checkbox']").length>0?p=!0:pageload=!1,setTimeout(function(){g(t)},500)):!0===p&&-1!==t.indexOf("?filter=true;")&&function(e){if(-1!==e.indexOf("?filter=true;")){var t=e.substr(e.indexOf("?filter=true;")+13,e.length),a=t.substr(0,t.length).split(";");h(a,0),u()}}(t)};g(l),e(document).on("click","*[type='checkbox']",function(e){u()}),e(document).on("click",".job-filter-button",function(t){t.preventDefault(),e.each(e(this).data(),function(t,a){e("#"+t).find("*[value='"+a+"']").prop("checked",!1)}),u()})});