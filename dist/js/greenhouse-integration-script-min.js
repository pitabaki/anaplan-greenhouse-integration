jQuery(document).ready(function(e){var t=function(e,t,a,n){this.title=e,this.categoryArr=t,this.appendID=a,this.markup=n},a=function(e,t){this.query=e,this.amount=t},n=[],o=window.location.href;if(o.indexOf("/jobs/")>0){var r=o.substr(o.indexOf("?id=")+4,o.length);if(console.log("currentJobID = "+r),r.length>1){e("#job-background").css("opacity",0);var i="https://boards-api.greenhouse.io/v1/boards/anaplan/jobs/"+r;e.getJSON(i,function(t){var a=t.content.replace(/&lt;/gi,"<");switch(a=(a=a.replace(/&gt;/gi,">")).replace(/&quot;/gi,'"'),e("#job-title").find("h1").html(t.title),e("#job-title-content").find("h3").html(t.title),e("#job-location").find("h3").html(t.location.name.trim()),e("#job-location-content").find("h5").html(t.location.name.trim()),e("#job-content").html(a),e("#job-greenhouse-href").attr("href",t.absolute_url),t.departments[0].name){case"Engineering":case"IT":case"Technical Operations":n="/careers/wp-content/uploads/sites/23/2018/12/solution_IT_feature.jpg";break;case"Field Sales":case"Inside Sales":case"Pre-Sales":case"Marketing":n="/careers/wp-content/uploads/sites/23/2018/12/solution_sales_feature.jpg";break;default:var n="/careers/wp-content/uploads/sites/23/2018/12/solution_supplyChain_feature.jpg"}e("#job-background").css({"background-image":"url("+n+")"}),setTimeout(function(){e("#job-background").css("opacity",1)},250);var o=t.departments[0].name;e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){console.log(t.departments);e.each(t.departments,function(a,n){var i=[],s="<div class='job-related--row'><p id='job-related--title' class='job-related--title'><a href='${job-href}'>${job-title}</a></p><p id='job-related--location' class='job-related--location'>${job-location}</p></div>",l=function(e){var t="https://anaplan.staging.wpengine.com/careers/jobs/?id="+e.id,a=s.replace(/\$\{job-title\}/gi,e.title);return a=(a=a.replace(/\$\{job-location\}/gi,e.location.name)).replace(/\$\{job-href\}/gi,t)};if(t.departments[a].name===o){var c=function(a,n){i.length<2&&n<t.departments.length?(e.each(t.departments[n].jobs,function(e,t){if(t.id!==parseInt(r)&&e<=5){var a=l(t);i.push(a)}}),c(a,++n)):i.length<2&&n===t.departments.length&&(n=a,e.each(t.departments[n].jobs,function(e,t){if(t.id!==parseInt(r)&&e<=5){var a=l(t);i.push(a)}}),c(a,++n))};c(0,a),e("#job-related-attach").html(i.join(""))}})})})}}else e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(o){var r=0,i=0,s=0,l=[],c=[],u=[],p=[],h=[],g="<li><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${value}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>",d="<div data-category='${category}' data-city='${city}' data-country='${country}' class='job-list-row job-list-row--active'><div class='job-list-column job-list-column--large'><p><a href='${job-href}'>${job-title}</a></p></div><div class='job-list-column job-list-column--small'><p>${category}</p></div><div class='job-list-column job-list-column--small'><p>${location}</p></div></div>",b=function(e,t,n){var o=e;if(t.length<1){var r=new a(o,1);t.push(r)}else if(n<t.length){if(o===t[n].query)return t[n].amount+=1,!1;b(e,t,++n)}else{r=new a(o,1);t.push(r)}};e.each(o.departments,function(e,t){if(t.jobs.length>0&&"Template"!==t.name){var n=new a(t.name,t.jobs.length);p.push(n);var o=t.jobs.map(function(e,t){var a=e.location.name.split(","),o="https://anaplan.staging.wpengine.com/careers/jobs/?id="+e.id;if(a.length>1){var r=a[0].trim().replace(/(\s-)|(-\s)/gi,"-"),i=a[1].trim().replace(/(\s-)|(-\s)/gi,"-");b(r,u,0),b(i,c,0),s=(s=d.replace(/\$\{city\}/gi,r)).replace(/\$\{country\}/gi,i)}else{i=a[0].trim().replace(/(\s-)|(-\s)/gi,"-");b(a[0],c,0);var s=d.replace(/\$\{country\}/gi,i)}return(s=(s=(s=s.replace(/\$\{job-href\}/gi,o)).replace(/\$\{job-title\}/gi,e.title)).replace(/\$\{location\}/gi,e.location.name.trim())).replace(/\$\{category\}/gi,n.query)});h.push(o.join(""))}switch(r+=t.jobs.length,t.name){case"Engineering":i+=t.jobs.length;var g=new a("engineering",i);l.push(g);break;case"Field Sales":s+=t.jobs.length;g=new a("sales",s);l.push(g)}}),e("<div/>",{html:h.join("")}).appendTo("#job-attach");var m=function(e){return e.sort(function(e,t){var a=e.query.toUpperCase(),n=t.query.toUpperCase();return a<n?-1:a>n?1:0})};c=m(c),u=m(u);var j=new t("Category",p,"category",g),f=new t("Country",c,"country",g),v=new t("City",u,"city",g);n.push(j),n.push(f),n.push(v);var y=new a("all",r);l.push(y),e.each(l,function(t,a){var n;e('*[data-job-type="'+(n=a).query+'"]').html(n.amount)});var w=function(t,a){if(a<t.length){var n=t[a].categoryArr,o=t[a].markup,r=n.map(function(e,t){return o.replace(/\$\{value\}/gi,e.query).replace(/\$\{amount\}/gi,e.amount)});e("<ul/>",{html:r.join("")}).appendTo("#"+t[a].appendID),w(t,++a)}};w(n,0)});e(document).on("click","*[type='checkbox']",function(t){var a=[],n=function(e){this.query=e,this.arr=[]},o=function(e,t,a){t<e.length&&(e.eq(t).hasClass(a)||e.eq(t).removeClass("job-list-row--active"),o(e,++t,a))},r=function(e,t,a){t<e.length&&(e.eq(t).hasClass("job-list-row--title")||e.eq(t).addClass("job-list-row--active"),r(e,++t,a))},i=e("*[type='checkbox']"),s=function(e,t,n){t<e.length&&(e[t].query.trim()===n.query.trim()?e[t].arr.push(n.arr[0]):t+1===e.length&&e[t].query.trim()!==n.query.trim()?a.push(n):s(e,++t,n))},l=function(e,t){if(t<e.length){if(!0===e.eq(t).prop("checked")){var o,r=e.eq(t).attr("value").trim(),i=e.eq(t).parents(".item-list").attr("id").trim();if(a.length>0)(o=new n(i)).arr.push(r),s(a,0,o);else(o=new n(i)).arr.push(r),a.push(o)}l(e,++t)}};o(e(".job-list-row"),0,"job-list-row--title"),l(i,0);var c=function(t,a,n){a<t.length&&(console.log("query = "+n),e("*[data-"+n+"='"+t[a]+"']").addClass("job-list-row--active"),c(t,++a,n))},u=function(e,t){t<e.length&&(0===t?(console.log("arr[num].query = "+e[t].query),c(e[t].arr,0,e[t].query)):(1===t&&t+1===e.length&&e[t-1].query,c(e[t].arr,0,e[t].query)),u(e,++t))};0===a.length?(o(e(".job-list-row"),0,"job-list-row--title"),r(e(".job-list-row"),0,"job-list-row--title")):u(a,0),console.log(a)})});