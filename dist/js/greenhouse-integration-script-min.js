jQuery(document).ready(function(e){var t=window.location.href,r=(t=t.substr(0,t.indexOf(".com")+4))+"/jobs/?id=",a=function(e,t,r,a){this.title=e,this.categoryArr=t,this.appendID=r,this.markup=a},o=function(e,t){this.query=e,this.amount=t},i=[],n=function(t,r){var a=e(r).length,o=e(t).length;a===o?e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>all</strong>")):e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>"+a+"</strong> of <strong>"+o+"</strong>"))},l=window.location.href;if(l.indexOf("/jobs/")>0){var s=l.substr(l.indexOf("?id=")+4,l.length);if(-1!==l.indexOf("?id=")){e("#job-background").css("opacity",0);var c="https://boards-api.greenhouse.io/v1/boards/anaplan/jobs/"+s;e.ajax({url:c}).done(function(t){var a=t.content.replace(/&lt;/gi,"<");a=(a=a.replace(/&gt;/gi,">")).replace(/&quot;/gi,'"'),e("#job-title").find("h1").html(t.title),e("#job-title-content").find("h3").html(t.title),e("#job-location").find("h3").html(t.location.name.trim()),e("#job-location-content").find("h5").html(t.location.name.trim()),e("#job-content").html(a),e("#job-greenhouse-href").attr("href",t.absolute_url);var o="/wp-content/uploads/2018/12/solution_IT_feature.jpg",i="/wp-content/uploads/2018/12/solution_sales_feature.jpg";switch(t.departments[0].name){case"Engineering":case"IT":case"Technical Operations":n=o;break;case"Field Sales":case"Inside Sales":case"Sales Development":case"Pre-Sales":case"Marketing":n=i;break;default:var n="/wp-content/uploads/2018/12/solution_supplyChain_feature.jpg"}e("#job-background").css({"background-image":"url("+n+")"}),setTimeout(function(){e("#job-background").css("opacity",1)},250);var l=t.departments[0].name;e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){e.each(t.departments,function(a,o){var i=[],n="<div class='job-related--row'><p id='job-related--title' class='job-related--title'><a href='${job-href}'>${job-title}</a></p><p id='job-related--location' class='job-related--location'>${job-location}</p></div>",c=function(e){var t=r+e.id,a=n.replace(/\$\{job-title\}/gi,e.title);return a=(a=a.replace(/\$\{job-location\}/gi,e.location.name)).replace(/\$\{job-href\}/gi,t)};if(t.departments[a].name===l){var u=function(r,a){i.length<2&&a<t.departments.length?(e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var r=c(t);i.push(r)}}),u(r,++a)):i.length<2&&a===t.departments.length&&(a=r,e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(s)&&e<=5){var r=c(t);i.push(r)}}),u(r,++a))};u(0,a),e("#job-related-attach").html(i.join(""))}})})}).fail(function(){window.location.href=window.location.href.substr(0,window.location.href.indexOf("/jobs"))+"/job-listing/"})}else window.location.href=window.location.href.substr(0,window.location.href.indexOf("/jobs"))+"/job-listing/"}else-1!==l.indexOf("/engineering")?l+="?filter=true;category=Engineering":-1!==l.indexOf("/sales")&&(l+="?filter=true;category=Field%20Sales&Pre-Sales&Sales%20Development"),e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){var l=0,s=0,c=0,u=[],h=[],p=[],f=[],b=[],d=[],g="<li><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${display}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>",j="<div data-search='${search}' data-category='${category}' data-city='${city}' data-country='${country}' data-title='${job-data-title}' class='job-list-row job-list-row--active job-list-row--filtered'><div class='job-list-column job-list-column--large'><p><a href='${job-href}'>${job-title}</a></p></div><div class='job-list-column job-list-column--small'><p>${category}</p></div><div class='job-list-column job-list-column--small'><p>${location}</p></div></div>",m=function(e,t,r){var a=e;if(t.length<1){var i=new o(a,1);t.push(i)}else if(r<t.length){if(a===t[r].query)return t[r].amount+=1,!1;m(e,t,++r)}else{i=new o(a,1);t.push(i)}};e.each(t.departments,function(t,a){if(a.jobs.length>0&&"Template"!==a.name){var i=new o(a.name.replace("Inside Sales","Sales Development"),a.jobs.length);b.push(i),e.each(a.jobs,function(e,t){var r=new o(t.title,1);f.push(r)});var n=a.jobs.map(function(e,t){var a=e.location.name.split(","),o=r+e.id,n=e.location.name.trim().toLowerCase()+","+e.title.toLowerCase();if(a.length>1){var l=a[0].trim().replace(/(\s-)|(-\s)/gi,"-"),s=a[1].trim().replace(/(\s-)|(-\s)/gi,"-");m(l,p,0),m(s,h,0),c=(c=j.replace(/\$\{city\}/gi,l.toLowerCase())).replace(/\$\{country\}/gi,s.toLowerCase())}else{s=a[0].trim().replace(/(\s-)|(-\s)/gi,"-");m(a[0],h,0);var c=j.replace(/\$\{country\}/gi,s.toLowerCase())}return(c=(c=(c=(c=(c=c.replace(/\$\{job-href\}/gi,o)).replace(/\$\{job-title\}/gi,e.title)).replace(/\$\{job-data-title\}/gi,e.title.toLowerCase())).replace(/\$\{location\}/gi,e.location.name.trim())).replace(/\$\{search\}/gi,n+i.query.trim().toLowerCase())).replace(/\$\{category\}/gi,i.query.trim().toLowerCase())});d.push(n.join(""))}switch(l+=a.jobs.length,a.name){case"Engineering":s+=a.jobs.length;var g=new o("engineering",s);u.push(g);break;case"Field Sales":c+=a.jobs.length;g=new o("sales",c);u.push(g)}}),e("<div/>",{html:d.join("")}).appendTo("#job-attach");var w=function(e){return e.sort(function(e,t){var r=e.query.toUpperCase(),a=t.query.toUpperCase();return r<a?-1:r>a?1:0})};h=w(h),p=w(p);var v=new a("Category",b,"category",g),y=new a("Country",h,"country",g),q=new a("City",p,"city",g);new a("Title",f,"title","<li style='display:none;'><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${display}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>");i.push(v),i.push(y),i.push(q);var $=new o("all",l);u.push($),e.each(u,function(t,r){var a;e('*[data-job-type="'+(a=r).query+'"]').html(a.amount)});var x=function(t,r){if(r<t.length){var a=t[r].categoryArr,o=t[r].markup,i=a.map(function(e,t){var r=o.replace(/\$\{value\}/gi,e.query.toLowerCase());return(r=r.replace(/\$\{display\}/gi,e.query)).replace(/\$\{amount\}/gi,e.amount)});e("<ul/>",{html:i.join("")}).appendTo("#"+t[r].appendID),x(t,++r)}};x(i,0),n(".job-list-row",".job-list-row--active.job-list-row--filtered")});var u=function(){var t=window.location.href;-1===window.location.href.indexOf("?search")&&e(".job-list-row").each(function(t,r){e(r).removeClass("job-list-row--search-exempt")});var r=[],a=[],o=function(e){this.query=e,this.arr=[]},i=function(e,t,r){t<e.length&&(e.eq(t).hasClass(r)||(e.eq(t).removeClass("job-list-row--active"),e.eq(t).removeClass("job-list-row--filtered")),i(e,++t,r))},l=function(e,t,r){t<e.length&&(e.eq(t).hasClass(r)||(e.eq(t).addClass("job-list-row--active"),e.eq(t).addClass("job-list-row--filtered")),l(e,++t,r))},s=e("*[type='checkbox']"),c=function(e,t,a){t<e.length&&(e[t].query.trim()===a.query.trim()?e[t].arr.push(a.arr[0]):t+1===e.length&&e[t].query.trim()!==a.query.trim()?r.push(a):c(e,++t,a))},u=function(e,t){if(t<e.length){if(!0===e.eq(t).prop("checked")&&void 0===e.eq(t).attr("id")){var a,i=e.eq(t).attr("value").trim(),n=e.eq(t).parents(".item-list").attr("id").trim();if(r.length>0)(a=new o(n)).arr.push(i),c(r,0,a);else(a=new o(n)).arr.push(i),r.push(a)}u(e,++t)}};i(e(".job-list-row"),0,"job-list-row--title"),u(s,0);var h=function(e,t,r){if(t<e.length){var o="<span class='job-filter-button job-filter-button--${color}' data-${query}='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>";o=(o=(o="category"===r?o.replace(/\$\{color\}/gi,"blue"):"search"===r?o.replace(/\$\{color\}/gi,"grey"):o.replace(/\$\{color\}/gi,"green")).replace(/\$\{filter\}/gi,e[t])).replace(/\$\{query\}/gi,r),a.push(o),h(e,++t,r)}},p=function(t,r,a){r<t.length&&(e("*[data-"+a+"='"+t[r]+"']").each(function(t,r){e(r).eq(0).hasClass("job-list-row--search-exempt")||e(r).eq(0).addClass("job-list-row--filtered")}),p(t,++r,a))},f=function(t,r,a){r<t.length&&(e("*[data-"+a+"='"+t[r]+"']").each(function(t,r){e(r).eq(0).hasClass("job-list-row--search-exempt")||e(r).eq(0).addClass("job-list-row--active")}),f(t,++r,a))},b=function(t,r){r<t.length&&(0===r&&1!==t.length?(f(t[r].arr,0,t[r].query),h(t[r].arr,0,t[r].query)):0===r&&"category"===t[r].query&&1===t.length?(f(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query),h(t[r].arr,0,t[r].query)):r>0?(p(t[r].arr,0,t[r].query),h(t[r].arr,0,t[r].query)):0===r&&1===t.length&&(f(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query),h(t[r].arr,0,t[r].query)),b(t,++r)),e("#job-filter-buttons").html(a.join(""))};0===r.length&&-1===t.indexOf("?search")?(i(e(".job-list-row"),0,"job-list-row--title"),l(e(".job-list-row"),0,"job-list-row--title"),e("#job-filter-buttons").html("")):-1===t.indexOf("?search")?b(r,0):g(t),n(".job-list-row",".job-list-row--active.job-list-row--filtered")},h=function(t){var r=[],a=[],o=e("*[type='checkbox']"),i=function(e){this.query=e,this.arr=[]},l=function(e,t,a){t<e.length&&(e[t].query.trim()===a.query.trim()?e[t].arr.push(a.arr[0]):t+1===e.length&&e[t].query.trim()!==a.query.trim()?r.push(a):l(e,++t,a))},s=function(e,t){if(t<e.length){if(!0===e.eq(t).prop("checked")&&void 0===e.eq(t).attr("id")){var a,o=e.eq(t).attr("value").trim(),n=e.eq(t).parents(".item-list").attr("id").trim();if(r.length>0)(a=new i(n)).arr.push(o),l(r,0,a);else(a=new i(n)).arr.push(o),r.push(a)}s(e,++t)}},c=function(e,t,r){t<e.length&&(e.eq(t).hasClass(r)||e.eq(t).hasClass("job-list-row--search-exempt")||(e.eq(t).removeClass("job-list-row--active"),e.eq(t).removeClass("job-list-row--filtered")),c(e,++t,r))},u=function(e,t,r){t<e.length&&(e.eq(t).hasClass(r)||e.eq(t).hasClass("job-list-row--search-exempt")||(e.eq(t).addClass("job-list-row--active"),e.eq(t).addClass("job-list-row--filtered")),u(e,++t,r))};c(e(".job-list-row"),0,"job-list-row--title"),s(o,0);var h,p=function(e,t,r){var o="<span class='job-filter-button job-filter-button--${color}' data-${query}='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>";o="category"===r?o.replace(/\$\{color\}/gi,"blue"):"search"===r?o.replace(/\$\{color\}/gi,"grey"):o.replace(/\$\{color\}/gi,"green"),t<e.length&&"object"==typeof e?(o=(o=o.replace(/\$\{filter\}/gi,e[t])).replace(/\$\{query\}/gi,r),a.push(o),p(e,++t,r)):"string"==typeof e&&(o=(o=o.replace(/\$\{filter\}/gi,e)).replace(/\$\{query\}/gi,r),a.push(o))},f=function(t,r,a){r<t.length&&(e("*[data-"+a+"='"+t[r]+"']").each(function(t,r){e(r).eq(0).hasClass("job-list-row--search-exempt")||e(r).eq(0).addClass("job-list-row--filtered")}),f(t,++r,a))},b=function(t,r,a){r<t.length&&(e("*[data-"+a+"='"+t[r]+"']").each(function(t,r){e(r).eq(0).hasClass("job-list-row--search-exempt")||e(r).eq(0).addClass("job-list-row--active")}),b(t,++r,a))},d=function(t,r){r<t.length&&(0===r&&1!==t.length?(b(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query)):0===r&&"category"===t[r].query&&1===t.length?(b(t[r].arr,0,t[r].query),f(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query)):r>0?(f(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query)):0===r&&1===t.length&&(b(t[r].arr,0,t[r].query),f(t[r].arr,0,t[r].query),p(t[r].arr,0,t[r].query)),d(t,++r)),e("#job-filter-buttons").html(a.join(""))};if(0===r.length){c(e(".job-list-row"),0,"job-list-row--title"),u(e(".job-list-row"),0,"job-list-row--title"),e("#job-filter-buttons").html("");var g=t.substr(t.indexOf("?search=")+8,t.length).replace(/\%20/gi," ");h=(h="<span class='job-filter-button job-filter-button--grey' data-search='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>").replace(/\$\{filter\}/gi,g),e("#job-filter-buttons").html(h)}else{g=t.substr(t.indexOf("?search=")+8,t.length).replace(/\%20/gi," ");p(g,0,"search"),d(r,0)}n(".job-list-row",".job-list-row--active.job-list-row--filtered")},p=!1,f=function(e,t){if(t<e.length){var r=e[t].substr(e[t].indexOf("=")+1,e[t].length).split("&");b(r,0),f(e,++t)}},b=function(t,r){r<t.length&&(e("*[value='"+t[r].replace(/%20/gi," ").toLowerCase()+"']").eq(0).prop("checked",!0),b(t,++r))},d=function(t){!1!==p||-1===t.indexOf("?filter=true;")&&-1===t.indexOf("?search")?!0===p&&-1!==t.indexOf("?filter=true;")?function(e){if(-1!==e.indexOf("?filter=true;")){var t=e.substr(e.indexOf("?filter=true;")+13,e.length),r=t.substr(0,t.length).split(";");f(r,0),u()}}(t):!0===p&&-1!==t.indexOf("?search")&&g(l):(e("*[type='checkbox']").length>0?p=!0:pageload=!1,setTimeout(function(){d(t)},500))};d(l);var g=function(t){var r,a=t.substr(t.indexOf("?search=")+8,t.length).replace(/\%20/gi," "),o=e(".job-list-row"),i=new RegExp(a,"gi");r=(r="<span class='job-filter-button job-filter-button--grey' data-search='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>").replace(/\$\{filter\}/gi,a),e("#job-filter-buttons").html(r),e.each(o,function(t,r){var a=e(r).attr("data-search");!0===i.test(a)?e(r).addClass("job-list-row--filtered"):!1===i.test(a)&&(e(r).removeClass("job-list-row--filtered"),e(r).addClass("job-list-row--search-exempt"))}),n(".job-list-row",".job-list-row--active.job-list-row--filtered")};e(document).on("submit","#career-search-form",function(t){t.preventDefault();var r=window.location.href,a=r.substr(0,r.indexOf(".com")+4);window.location.href=a+"/job-listing/?search="+e("#form-field-name").val().trim()}),e(document).on("click","*[type='checkbox']",function(e){var t=window.location.href;-1===t.indexOf("?search")?u():h(t)}),e(document).on("click",".job-filter-button",function(t){t.preventDefault(),e.each(e(this).data(),function(t,r){"search"!==t.trim()?e("#"+t).find("*[value='"+r+"']").prop("checked",!1):history.pushState(null,null,"/job-listing/")});var r=window.location.href;-1===r.indexOf("?search")?u():h(r)})});