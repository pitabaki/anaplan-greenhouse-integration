jQuery(document).ready(function(e){var t=function(e,t,r,a){this.title=e,this.categoryArr=t,this.appendID=r,this.markup=a},r=function(e,t){this.query=e,this.amount=t},a=[],n=function(t,r){var a=e(r).length,n=e(t).length;a===n?e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>all</strong>")):e("#job-list-total").html("<p>Displaying ${amount} entries".replace(/\$\{amount\}/gi,"<strong>"+a+"</strong> of <strong>"+n+"</strong>"))},o=window.location.href;if(o.indexOf("/jobs/")>0){var i=o.substr(o.indexOf("?id=")+4,o.length);if(console.log("currentJobID = "+i),i.length>1){e("#job-background").css("opacity",0);var l="https://boards-api.greenhouse.io/v1/boards/anaplan/jobs/"+i;e.getJSON(l,function(t){var r=t.content.replace(/&lt;/gi,"<");switch(r=(r=r.replace(/&gt;/gi,">")).replace(/&quot;/gi,'"'),e("#job-title").find("h1").html(t.title),e("#job-title-content").find("h3").html(t.title),e("#job-location").find("h3").html(t.location.name.trim()),e("#job-location-content").find("h5").html(t.location.name.trim()),e("#job-content").html(r),e("#job-greenhouse-href").attr("href",t.absolute_url),t.departments[0].name){case"Engineering":case"IT":case"Technical Operations":a="/careers/wp-content/uploads/sites/23/2018/12/solution_IT_feature.jpg";break;case"Field Sales":case"Inside Sales":case"Pre-Sales":case"Marketing":a="/careers/wp-content/uploads/sites/23/2018/12/solution_sales_feature.jpg";break;default:var a="/careers/wp-content/uploads/sites/23/2018/12/solution_supplyChain_feature.jpg"}e("#job-background").css({"background-image":"url("+a+")"}),setTimeout(function(){e("#job-background").css("opacity",1)},250);var n=t.departments[0].name;e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(t){console.log(t.departments);e.each(t.departments,function(r,a){var o=[],l="<div class='job-related--row'><p id='job-related--title' class='job-related--title'><a href='${job-href}'>${job-title}</a></p><p id='job-related--location' class='job-related--location'>${job-location}</p></div>",s=function(e){var t="https://anaplan.staging.wpengine.com/careers/jobs/?id="+e.id,r=l.replace(/\$\{job-title\}/gi,e.title);return r=(r=r.replace(/\$\{job-location\}/gi,e.location.name)).replace(/\$\{job-href\}/gi,t)};if(t.departments[r].name===n){var c=function(r,a){o.length<2&&a<t.departments.length?(e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(i)&&e<=5){var r=s(t);o.push(r)}}),c(r,++a)):o.length<2&&a===t.departments.length&&(a=r,e.each(t.departments[a].jobs,function(e,t){if(t.id!==parseInt(i)&&e<=5){var r=s(t);o.push(r)}}),c(r,++a))};c(0,r),e("#job-related-attach").html(o.join(""))}})})})}}else-1!==o.indexOf("/engineering")?o+="?filter=true;category=Engineering":-1!==o.indexOf("/sales")&&(o+="?filter=true;category=Field%20Sales"),e.getJSON("https://boards-api.greenhouse.io/v1/boards/anaplan/departments/",function(o){var i=0,l=0,s=0,c=[],u=[],p=[],g=[],h=[],d="<li><span class='item-title-checkbox'><input name='${value}' value='${value}' type='checkbox' /><label>${value}</label></span><span class='item-amount'><span class='item-amount-container'>${amount}</span></span></li>",b="<div data-category='${category}' data-city='${city}' data-country='${country}' class='job-list-row job-list-row--active job-list-row--filtered'><div class='job-list-column job-list-column--large'><p><a href='${job-href}'>${job-title}</a></p></div><div class='job-list-column job-list-column--small'><p>${category}</p></div><div class='job-list-column job-list-column--small'><p>${location}</p></div></div>",f=function(e,t,a){var n=e;if(t.length<1){var o=new r(n,1);t.push(o)}else if(a<t.length){if(n===t[a].query)return t[a].amount+=1,!1;f(e,t,++a)}else{o=new r(n,1);t.push(o)}};e.each(o.departments,function(e,t){if(t.jobs.length>0&&"Template"!==t.name){var a=new r(t.name,t.jobs.length);g.push(a);var n=t.jobs.map(function(e,t){var r=e.location.name.split(","),n="https://anaplan.staging.wpengine.com/careers/jobs/?id="+e.id;if(r.length>1){var o=r[0].trim().replace(/(\s-)|(-\s)/gi,"-"),i=r[1].trim().replace(/(\s-)|(-\s)/gi,"-");f(o,p,0),f(i,u,0),l=(l=b.replace(/\$\{city\}/gi,o)).replace(/\$\{country\}/gi,i)}else{i=r[0].trim().replace(/(\s-)|(-\s)/gi,"-");f(r[0],u,0);var l=b.replace(/\$\{country\}/gi,i)}return(l=(l=(l=l.replace(/\$\{job-href\}/gi,n)).replace(/\$\{job-title\}/gi,e.title)).replace(/\$\{location\}/gi,e.location.name.trim())).replace(/\$\{category\}/gi,a.query)});h.push(n.join(""))}switch(i+=t.jobs.length,t.name){case"Engineering":l+=t.jobs.length;var o=new r("engineering",l);c.push(o);break;case"Field Sales":s+=t.jobs.length;o=new r("sales",s);c.push(o)}}),e("<div/>",{html:h.join("")}).appendTo("#job-attach");var m=function(e){return e.sort(function(e,t){var r=e.query.toUpperCase(),a=t.query.toUpperCase();return r<a?-1:r>a?1:0})};u=m(u),p=m(p);var j=new t("Category",g,"category",d),y=new t("Country",u,"country",d),v=new t("City",p,"city",d);a.push(j),a.push(y),a.push(v);var w=new r("all",i);c.push(w),e.each(c,function(t,r){var a;e('*[data-job-type="'+(a=r).query+'"]').html(a.amount)});var q=function(t,r){if(r<t.length){var a=t[r].categoryArr,n=t[r].markup,o=a.map(function(e,t){return n.replace(/\$\{value\}/gi,e.query).replace(/\$\{amount\}/gi,e.amount)});e("<ul/>",{html:o.join("")}).appendTo("#"+t[r].appendID),q(t,++r)}};q(a,0),n(".job-list-row",".job-list-row--active.job-list-row--filtered")});var s=function(){var t=[],r=[],a=function(e){this.query=e,this.arr=[]},o=function(e,t,r){t<e.length&&(e.eq(t).hasClass(r)||(e.eq(t).removeClass("job-list-row--active"),e.eq(t).removeClass("job-list-row--filtered")),o(e,++t,r))},i=function(e,t,r){t<e.length&&(e.eq(t).hasClass("job-list-row--title")||(e.eq(t).addClass("job-list-row--active"),e.eq(t).addClass("job-list-row--filtered")),i(e,++t,r))},l=e("*[type='checkbox']"),s=function(e,r,a){r<e.length&&(e[r].query.trim()===a.query.trim()?e[r].arr.push(a.arr[0]):r+1===e.length&&e[r].query.trim()!==a.query.trim()?t.push(a):s(e,++r,a))},c=function(e,r){if(r<e.length){if(!0===e.eq(r).prop("checked")){var n,o=e.eq(r).attr("value").trim(),i=e.eq(r).parents(".item-list").attr("id").trim();if(t.length>0)(n=new a(i)).arr.push(o),s(t,0,n);else(n=new a(i)).arr.push(o),t.push(n)}c(e,++r)}};o(e(".job-list-row"),0,"job-list-row--title"),c(l,0);var u=function(e,t,a){if(t<e.length){var n="<span class='job-filter-button job-filter-button--${color}' data-${query}='${filter}'>${filter} <span class='job-filter-button--delete'>x</span></span>";n=(n=(n="category"===a?n.replace(/\$\{color\}/gi,"blue"):n.replace(/\$\{color\}/gi,"green")).replace(/\$\{filter\}/gi,e[t])).replace(/\$\{query\}/gi,a),r.push(n),u(e,++t,a)}},p=function(t,r,a){r<t.length&&(console.log("removeFilterProcess Called"),e("*[data-"+a+"='"+t[r]+"']").addClass("job-list-row--filtered"),p(t,++r,a))},g=function(t,r,a){r<t.length&&(console.log("additiveFilterProcess Called"),e("*[data-"+a+"='"+t[r]+"']").addClass("job-list-row--active"),g(t,++r,a))},h=function(t,a){a<t.length&&(0===a&&"category"===t[a].query&&1!==t.length?(g(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0===a&&"category"===t[a].query&&1===t.length?(g(t[a].arr,0,t[a].query),p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0!==a||"city"!==t[a].query&&"country"!==t[a].query||1===t.length?a>0&&("city"===t[a].query||"country"===t[a].query)?(p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):0===a&&1===t.length&&(g(t[a].arr,0,t[a].query),p(t[a].arr,0,t[a].query),u(t[a].arr,0,t[a].query)):g(t[a].arr,0,t[a].query),h(t,++a)),e("#job-filter-buttons").html(r.join(""))};console.log("checkedArr.length = "+t.length),0===t.length?(o(e(".job-list-row"),0,"job-list-row--title"),i(e(".job-list-row"),0,"job-list-row--title"),e("#job-filter-buttons").html("")):h(t,0),n(".job-list-row",".job-list-row--active.job-list-row--filtered")},c=!1,u=function(e,t){if(t<e.length){var r=e[t].substr(e[t].indexOf("=")+1,e[t].length).split("&");p(r,0),u(e,++t)}},p=function(t,r){r<t.length&&(console.log(t[r].replace(/%20/gi," ")),e("*[value='"+t[r].replace(/%20/gi," ")+"']").eq(0).prop("checked",!0),p(t,++r))},g=function(t){!1===c&&-1!==t.indexOf("?filter=true;")?(e("*[type='checkbox']").length>0?c=!0:pageload=!1,setTimeout(function(){g(t)},500)):!0===c&&-1!==t.indexOf("?filter=true;")&&function(e){if(-1!==e.indexOf("?filter=true;")){var t=e.substr(e.indexOf("?filter=true;")+13,e.length),r=t.substr(0,t.length).split(";");u(r,0),s()}}(t)};g(o),e(document).on("click","*[type='checkbox']",function(e){s()}),e(document).on("click",".job-filter-button",function(t){t.preventDefault(),console.log(e(this).data()),e.each(e(this).data(),function(t,r){console.log(t),console.log(r),e("#"+t).find("*[value='"+r+"']").prop("checked",!1)}),s()})});